<div class="grid grid-cols-1 lg:grid-cols-4 gap-5 max-w-7xl mx-auto">

    <!-- LEFT: TRENDING JOBS/OFFERS/PROJECTS -->
    <div class="hidden lg:flex flex-col gap-4 col-span-1">
        <!-- Relevant Jobs -->
        <div class="bg-gray-800/50 border border-gray-700 rounded-lg p-3 shadow-sm">
            <h3 class="flex gap-4 items-center mb-2 border-b pb-2 border-gray-700">
                <span class="font-semibold text-blue-500">
                    Available Jobs
                </span>
                <span class="text-[10px] bg-gray-900/50 text-green-400 py-1 px-2 rounded-full">
                    Recommended
                </span>
            </h3>
            <ul class="flex flex-col text-sm">
                <li>
                    <a href="#"
                        class="flex items-center justify-between text-gray-400 hover:text-blue-500 transition py-1 pl-2 pr-1 rounded-lg hover:bg-gray-900">
                        <span class="truncate">
                            Ali Institute Multan
                        </span>
                        <span class="bg-gray-900/50 text-blue-500 py-1 px-2 rounded">
                            Fullstack
                        </span>
                    </a>
                </li>
                <li>
                    <a href="#"
                        class="flex items-center justify-between text-gray-400 hover:text-blue-500 transition py-1 pl-2 pr-1 rounded-lg hover:bg-gray-900">
                        <span class="truncate">
                            Microsoft Azure
                        </span>
                        <span class="bg-gray-900/50 text-blue-500 py-1 px-2 rounded">
                            CI/CD
                        </span>
                    </a>
                </li>
                <li>
                    <a href="#"
                        class="flex items-center justify-between text-gray-400 hover:text-blue-500 transition py-1 pl-2 pr-1 rounded-lg hover:bg-gray-900">
                        <span class="truncate">
                            Sabatier Sanders Co
                        </span>
                        <span class="bg-gray-900/50 text-blue-500 py-1 px-2 rounded">
                            AI/ML
                        </span>
                    </a>
                </li>
                <li>
                    <a href="#"
                        class="flex items-center justify-between text-gray-400 hover:text-blue-500 transition py-1 pl-2 pr-1 rounded-lg hover:bg-gray-900">
                        <span class="truncate">
                            Google LLC
                        </span>
                        <span class="bg-gray-900/50 text-blue-500 py-1 px-2 rounded">
                            Data Science
                        </span>
                    </a>
                </li>
                <li>
                    <a href="#"
                        class="flex items-center justify-between text-gray-400 hover:text-blue-500 transition py-1 pl-2 pr-1 rounded-lg hover:bg-gray-900">
                        <span class="truncate">
                            Netflix.com USA
                        </span>
                        <span class="bg-gray-900/50 text-blue-500 py-1 px-2 rounded">
                            Backend
                        </span>
                    </a>
                </li>
            </ul>
        </div>

        <!-- Relevant Projects -->
        <div class="bg-gray-800/50 border border-gray-700 rounded-lg p-3 shadow-sm">
            <h3 class="flex gap-4 items-center mb-2 border-b pb-2 border-gray-700">
                <span class="font-semibold text-blue-500">
                    Explore Projects
                </span>
                <span class="text-[10px] bg-gray-900/50 text-green-400 py-1 px-2 rounded-full">
                    Recommended
                </span>
            </h3>
            <ul class="flex flex-col text-sm">
                <li>
                    <a href="#"
                        class="flex flex-col gap-1 px-2 py-1 rounded-lg truncate text-gray-400 hover:text-blue-500 hover:bg-gray-900">
                        <div class="truncate">
                            DevHuddle_ Open Source Project for Experts
                        </div>
                        <div class="truncate text-xs flex gap-1.5">
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                Typescript
                            </span>
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                React
                            </span>
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                JS
                            </span>
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                HTML/CSS
                            </span>
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                Django
                            </span>
                        </div>
                    </a>
                </li>
                <div class="h-px bg-gray-700 my-1"></div>
                <li>
                    <a href="#"
                        class="flex flex-col gap-1 px-2 py-1 rounded-lg truncate text-gray-400 hover:text-blue-500 hover:bg-gray-900">
                        <div class="truncate">
                            Coding Shuttle AI based code editor
                        </div>
                        <div class="truncate text-xs flex gap-1.5">
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                Neuralink
                            </span>
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                Python
                            </span>
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                PyTorch
                            </span>
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                Cassandra
                            </span>
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                TS
                            </span>
                        </div>
                    </a>
                </li>
                <div class="h-px bg-gray-700 my-1"></div>
                <li>
                    <a href="#"
                        class="flex flex-col gap-1 px-2 py-1 rounded-lg truncate text-gray-400 hover:text-blue-500 hover:bg-gray-900">
                        <div class="truncate">
                            Camel Case Kids Competition 3D Game
                        </div>
                        <div class="truncate text-xs flex gap-1.5">
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                C#
                            </span>
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                Unity
                            </span>
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                C/C++
                            </span>
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                Linux
                            </span>
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                APIs
                            </span>
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                RESTFul API
                            </span>
                        </div>
                    </a>
                </li>
                <div class="h-px bg-gray-700 my-1"></div>
                <li>
                    <a href="#"
                        class="flex flex-col gap-1 px-2 py-1 rounded-lg truncate text-gray-400 hover:text-blue-500 hover:bg-gray-900">
                        <div class="truncate">
                            Sorrow 3.0 Mega | Augmented Reality Platform
                        </div>
                        <div class="truncate text-xs flex gap-1.5">
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                Spring Boot
                            </span>
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                Java
                            </span>
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                JUnit5
                            </span>
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                Python
                            </span>
                            <span class="px-1 py-0.5 rounded bg-gray-900/50 text-blue-500">
                                JS/TS
                            </span>
                        </div>
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <!-- CENTER: FEED / MAIN STREAM -->
    <div class="col-span-1 lg:col-span-2">
        <!-- FEED BUTTONS -->
        <div
            class="grid grid-cols-4 border-t gap-[2px] border-gray-800 sm:rounded-b-2xl rounded-b-lg mb-4 overflow-hidden">
            <a href="?feed=global" class="py-2 text-sm text-center transition
                {% if current_feed == 'global' %} text-blue-500 font-semibold bg-gray-950
                {% else %} text-gray-400 hover:text-blue-500 hover:bg-gray-950 {% endif %}">
                Global </a>

            <a href="?feed=fellows" class="py-2 text-sm text-center transition
                {% if current_feed == 'fellows' %} text-blue-500 font-semibold bg-gray-950
                {% else %} text-gray-400 hover:text-blue-500 hover:bg-gray-950 {% endif %}">
                Fellows </a>

            <a href="?feed=business" class="py-2 text-sm text-center transition
                {% if current_feed == 'business' %} text-blue-500 font-semibold bg-gray-950
                {% else %} text-gray-400 hover:text-blue-500 hover:bg-gray-950 {% endif %}">
                Business </a>

            <a href="?feed=ads" class="py-2 text-sm text-center transition
                {% if current_feed == 'ads' %} text-blue-500 font-semibold bg-gray-950
                {% else %} text-gray-400 hover:text-blue-500 hover:bg-gray-950 {% endif %}">
                Advertisers </a>
        </div>

        <!-- POSTS -->
        <div class="space-y-6">
            {% for post in posts %}
            <div class="bg-gray-800 p-3 rounded-lg mb-4 border border-gray-600 transition shadow-lg">
                <div class="flex items-center justify-between mb-2">
                    <!-- AUTHOR'S INFO & LOGO -->
                    <div class="flex items-center gap-3">
                        {% if post.author.avatar %}
                        <a href="{% url 'user_profile' post.author.username %}" class="hover:opacity-70">
                            <img src="{{ post.author.avatar.url }}"
                                class="w-10 h-10 rounded-full object-cover border border-gray-600">
                        </a>

                        {% else %}
                        <!-- PROFILE ICON LETTER -->
                        <a href="{% url 'user_profile' post.author.username %}" class="hover:opacity-70">
                            <div
                                class="w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center font-bold text-gray-100 text-sm">
                                {{ post.author.username|slice:":1"|upper }}
                            </div>
                        </a>
                        {% endif %}

                        <div class="leading-tight">
                            <a href="{% url 'user_profile' post.author.username %}"
                                class="block font-semibold text-gray-300 hover:text-blue-400 transition">
                                @{{ post.author.username }}
                            </a>
                            <span class="block text-xs text-gray-500">
                                {{ post.created_at|date:"d M Y ‚Ä¢ h:i:s A" }}
                            </span>
                        </div>
                    </div>

                    <!-- EDIT/DELETE MENU -->
                    {% if post.author == user %}
                    <div class="relative">
                        <button onclick="togglePostMenu('{{ post.pk }}')"
                            class="text-gray-400 hover:text-white p-2 hover:bg-gray-700/50 rounded-full transition cursor-pointer">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z">
                                </path>
                            </svg>
                        </button>

                        <div id="post-menu-{{ post.pk }}"
                            class="hidden absolute right-0 mt-2 w-36 bg-gray-800 rounded-lg shadow-xl border border-gray-700 z-20 overflow-hidden">
                            <a href="{% url 'post_edit' pk=post.pk %}"
                                class="block px-4 py-2 text-sm text-gray-100 hover:bg-gray-700 hover:text-white transition">
                                Edit Post
                            </a>
                            <div class="h-px bg-gray-700 mx-2 my-1"></div>
                            <a href="{% url 'post_delete' pk=post.pk %}"
                                class="block px-4 py-2 text-sm text-red-400 hover:bg-red-900/20 hover:text-red-300 transition">
                                Delete Post
                            </a>
                        </div>
                    </div>

                    {% else %}
                    <div class="flex gap-2 items-center">
                        <!-- LIKE BUTTON -->
                        <button onclick="toggleLike(event, '{{ post.pk }}')"
                            class="flex items-center gap-1 group transition focus:outline-none cursor-pointer">

                            <div id="like-icon-{{ post.pk }}">
                                {% if user in post.likes.all %}
                                <svg class="w-6 h-6 text-red-500 group-hover:scale-110 transition-transform"
                                    fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                                </svg>
                                {% else %}
                                <svg class="w-6 h-6 text-gray-400 group-hover:text-red-500 group-hover:scale-110 transition-transform"
                                    fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z">
                                    </path>
                                </svg>
                                {% endif %}
                            </div>

                            <span id="like-count-{{ post.pk }}"
                                class="text-sm font-bold {% if user in post.likes.all %}text-red-500{% else %}text-gray-400{% endif %}">
                                {{ post.likes.count }}
                            </span>
                        </button>

                        <!-- COMMENT BUTTON -->
                        <a href="{% url 'post_detail' post.pk %}"
                            class="flex items-center gap-1 text-gray-400 hover:text-blue-400 transition cursor-pointer hover:pb-1">
                            <span class="text-xl">üí¨</span>
                            <span class="text-sm font-bold">{{ post.comments.count }}</span>
                        </a>

                        <!-- POST REACTION OPTIONS -->
                        <div class="relative">
                            <button onclick="togglePostMenu('{{ post.pk }}')"
                                class="text-gray-400 hover:text-white p-2 hover:bg-gray-700/50 rounded-full transition cursor-pointer">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z">
                                    </path>
                                </svg>
                            </button>
                            <div id="post-menu-{{ post.pk }}"
                                class="hidden absolute right-0 mt-2 w-36 bg-gray-800 rounded-lg shadow-xl border border-gray-700 z-20 overflow-hidden">
                                <a href="#"
                                    class="border-b border-gray-700 block px-4 py-2 text-sm text-gray-100 hover:bg-gray-700 transition">Boost
                                    it ‚ö°</a>
                                <a href="#"
                                    class="border-b border-gray-700 block px-4 py-2 text-sm text-gray-100 hover:bg-gray-700 transition">Learn
                                    by AI</a>
                                <a href="#"
                                    class="border-b border-gray-700 block px-4 py-2 text-sm text-gray-100 hover:bg-gray-700 transition">Check
                                    Profile</a>
                                <a href="#"
                                    class="border-b border-gray-700 block px-4 py-2 text-sm text-gray-100 hover:bg-gray-700 transition">See
                                    Comments</a>
                                <a href="#"
                                    class="border-b border-gray-700 block px-4 py-2 text-sm text-gray-100 hover:bg-gray-700 transition">
                                    Report this</a>
                                <a href="#"
                                    class="border-b border-gray-700 block px-4 py-2 text-sm text-gray-100 hover:bg-gray-700 transition">
                                    Bookmark</a>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </div>

                <!-- POST BODY -->
                <p class="text-gray-400 leading-relaxed mt-1">{{ post.body }}</p>
                {% if post.image %}
                <div class="mt-3 rounded-lg overflow-hidden border border-gray-700">
                    <img src="{{ post.image.url }}" alt="Post Image" class="w-full h-auto object-cover max-h-[500px]">
                </div>
                {% endif %}
            </div>
            <!-- FRESH FEED / EMPTY FEED PAGES -->
            {% empty %}
            {% if current_feed == 'fellows' and who_to_follow %}
            <div class="text-center mb-4">
                <h2 class="text-lg font-semibold text-gray-400 mt-8 mb-2">Your huddle is empty!</h2>
                <p class="text-gray-400 mb-8">Connect with these top developers to start your feed ü¶ó</p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-3">
                    {% for suggestion in who_to_follow %}
                    <div
                        class="bg-gray-800 p-2 rounded-lg flex gap-2 items-center justify-between border border-gray-700">
                        <div class="flex items-center gap-3 sm:gap-2 truncate">
                            {% if suggestion.avatar %}
                            <img src="{{ suggestion.avatar.url }}" class="w-10 h-10 rounded-full object-cover">
                            {% else %}
                            <div
                                class="w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center font-bold text-white shrink-0">
                                {{ suggestion.username|slice:":1"|upper }}
                            </div>
                            {% endif %}

                            <div class="text-left truncate text-gray-500">
                                <span class="block font-semibold text-blue-500">
                                    @{{ suggestion.username }}
                                </span>
                                <span class="text-xs text-gray-500">
                                    {% if suggestion.bio %}
                                    {{ suggestion.bio}}
                                    {% else %}
                                    {{ suggestion.tech_stack }}
                                    {% endif %}
                                </span>
                            </div>
                        </div>

                        <a href="{% url 'user_profile' suggestion.username %}"
                            class="text-sm bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded-full transition">
                            View
                        </a>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% else %}
            <div class="text-center text-gray-500 mt-10">
                <p>No posts found here yet.</p>
            </div>
            {% endif %}
            {% endfor %}


            <!-- PAGINATION -->
            {% if is_paginated %}
            <div class="flex justify-center items-center space-x-4 mt-8">

                {% if page_obj.has_previous %}
                <a href="?page={{ page_obj.previous_page_number }}"
                    class="px-2 py-1 bg-gray-800 border border-gray-600 rounded-lg text-gray-100 hover:bg-blue-600 hover:text-white hover:border-blue-500 transition shadow-md cursor-pointer">
                    &larr; Previous
                </a>
                {% else %}
                <span
                    class="px-2 py-1 bg-gray-800/50 border border-gray-700 rounded-lg text-gray-600 cursor-not-allowed">
                    &larr; Previous
                </span>
                {% endif %}

                <span class="text-sm text-gray-400 font-mono">
                    Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
                </span>

                {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}"
                    class="px-2 py-1 bg-gray-800 border border-gray-600 rounded-lg text-gray-100 hover:bg-blue-600 hover:text-white hover:border-blue-500 transition shadow-md cursor-pointer">
                    Next &rarr;
                </a>
                {% else %}
                <span
                    class="px-2 py-1 bg-gray-800/50 border border-gray-700 rounded-lg text-gray-600 cursor-not-allowed">
                    Next &rarr;
                </span>
                {% endif %}

            </div>
            {% endif %}

        </div>
    </div>

    <!-- RIGHT: TRENDING ACCOUNTS + AI-CHAT-SECTION -->
    <div class="hidden lg:block col-span-1 space-y-6">

        <div class="bg-gray-800/60 border border-gray-700 rounded-xl p-4 shadow-sm">
            <h3 class="flex gap-4 items-center mb-2 border-b pb-2 border-gray-700">
                <span class="font-semibold text-blue-500">
                    Popular Developers
                </span>
                <span class="text-[10px] bg-gray-900/50 text-green-400 py-1 px-2 rounded-full">
                    Recommended
                </span>
            </h3>

            <div class="space-y-4">
                {% for suggestion in who_to_follow %}
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        {% if suggestion.avatar %}
                        <img src="{{ suggestion.avatar.url }}" class="w-9 h-9 rounded-full object-cover">
                        {% else %}
                        <div
                            class="w-9 h-9 rounded-full bg-gray-900 flex items-center justify-center font-bold text-blue-500 text-xs">
                            {{ suggestion.username|slice:":1"|upper }}
                        </div>
                        {% endif %}

                        <div class="overflow-hidden">
                            <a href="{% url 'user_profile' suggestion.username %}"
                                class="block font-semibold text-sm text-gray-400 hover:text-blue-500 truncate w-24">
                                @{{ suggestion.username }}
                            </a>
                            <p class="text-[10px] text-blue-500 truncate w-24">
                                {{ suggestion.tech_stack|default:"Developer" }}</p>
                        </div>

                        <!-- Rating: on basis of performance -->
                        <div class="text-xs text-yellow-400">
                            ‚≠ê5
                        </div>

                        <!-- Rating: on basics of public boosts -->
                        <div class="text-xs text-orange-500">
                            ‚ö°3
                        </div>
                    </div>

                    <a href="{% url 'user_profile' suggestion.username %}"
                        class="text-xs border border-gray-700 text-blue-500 hover:bg-gray-900 hover:text-gray-400 px-2 py-1 rounded-full transition">
                        View
                    </a>
                </div>
                {% empty %}
                <p class="text-sm text-gray-400 italic">No suggestions right now.</p>
                {% endfor %}
            </div>

            <div class="flex items-center justify-between mt-4 pt-2 border-t border-gray-700">
                <a href="{% url 'search' %}" class="text-xs text-blue-500 hover:underline">Show more</a>

                <div class="flex items-center gap-4 text-xs">
                    <span class="text-yellow-400">Rating ‚≠ê</span>
                    <span class="text-orange-500">Boosting ‚ö°</span>
                </div>
            </div>
        </div>

    </div>

</div>